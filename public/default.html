
<!DOCTYPE html>
<html>
<head>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Devrecord - Home</title>
	<link rel="stylesheet" type="text/css" href="/stylesheets/style.css">

	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
	<script type="text/javascript" src="../jsmpg.js"></script>
	<script type="text/javascript">
	$(document).ready(function() {
		if (/mobile/.test(window.location.href))
		{
			$('#header').css('font-size','18px')
			$('#main-strip').width('350px');
			$('.subject').css('padding','0px').css('width','350px')
		}

		function mumbleBenPresent() {
			$('#mumble-status')
			.removeClass('red')
			.addClass('green')
			.html('Online, Join me <span>@206.217.198.148:6132</span>')
		}

		function mumbleBenNotPresent() {
			$('#mumble-status')
			.removeClass('green')
			.addClass('red')
			.text('Offline');
		}

		function refreshMumbleStuff() {
			try {
				$.get('/onmumble',function(data) {
					var mumbleusers = JSON.parse(data)['root']['users'];
					mumbleBenNotPresent();
					for (user in mumbleusers) {
						if (mumbleusers[user].name == 'Sammons')
							mumbleBenPresent();
					}
				})
			} catch (e) {
				console.log(e);// who cares, right?
			}
		}

		$('#mumble-status').text('Refreshing...')
		refreshMumbleStuff();
		setInterval(refreshMumbleStuff,5000);


		function send_command(val, spark) {
			$.post('/spark/'+spark+'/'+val)
		}
		function widget(append_to,i, name) {
			var wid = $('<div  class = "spark found" id="spark-' + i + '">' +
							'<span class = "name">' + name + '</span><button>Go</button>' +
							'<span class = "statement"></span>' +
							'<br/><input class="r" type=range min="0" max="255">R<br/>' +
							'<input class="g" type=range min="0" max="255">G<br/>' +
							'<input class="b" type=range min="0" max="255">B' +
							'</div>');
			append_to.append(wid).find('#spark-'+i+' button').click(function(){
					var val = $('#spark-'+i+' .r').val()+','+$('#spark-'+i+' .g').val()+','+$('#spark-'+i+' .b').val();
					send_command(val, i)
				})
		}
		function refreshSparkMessages() {
			$.get('/spark',function(data) {
				console.log(data);
				var sparkArry = [];
				var sparks = JSON.parse(data);
				for (var i in sparks) {
					$('#spark-'+i).addClass('found');
					if (!$('#spark-'+i).length > 0) {
						(function(){widget($('#spark-ui'),i, sparks[i].name)})()
					}
				}
				$('.spark').each(function(i,e) {
					if (!$(e).hasClass('found')) $(e).remove();
				});
				$('.found').removeClass('found');
			})
		}

		setInterval(refreshSparkMessages,400);

		function command(com) {
			$.get('/'+com);
		}

		$('#blue').click(function(){ command('blue') })
		$('#green').click(function(){ command('green') })
		$('#red').click(function(){ command('red') })
					// Show loading notice
		var canvas = document.getElementById('videoCanvas');
		var ctx = canvas.getContext('2d');
		ctx.fillStyle = '#444';
		ctx.fillText('Loading...', canvas.width/2-30, canvas.height/3);

		// Setup the WebSocket connection and start the player
		var client = new WebSocket( 'ws://devrecord.com:8084/' );
		var player = new jsmpeg(client, {canvas:canvas});
		setInterval(function() {
			player = new jsmpeg(client, {canvas: canvas});
		},30*60*1000);
	})
	</script>
</head>
<body id="page">

<!-- begin main content -->

<div id="main-strip">
	<a href="/"><div id="logo"></div></a>
	<div id="header"><h1>Welcome</h1></div>

	<div class = "spacer"></div>

	<div class = "subject">
		<h4>Recent explorations:</h4>
		<ul>
			<li>None yet, this site just got refreshed</li>
		</ul>
	</div>

	<div class = "subject">
		<h4>Is Ben coding right now? <br/> <span class = "red"> Indicators:</span> </h4>
		<ul>
			<li>Mumble: <a href="mumble://206.217.198.148:6132"><span class="red" id="mumble-status"></span></a></li>
			<li title="Floobits is a realtime coding environ, you can code with me easy and free!">Floobits:<a href="https://floobits.com/Sammons/" class="green"><br/></a><a href="https://floobits.com/Sammons/devrecord/redirect">
  			<img alt="Floobits status" width="100" height="40" src="https://floobits.com/Sammons/devrecord.png" />
			</a><br/><span class="small">(if it says info, no one is there)</span></li>
		</ul>
	</div>

	<!-- we aren't supposed to do it this way, but it works really well -->
	<div class = "spacer"> </div>

	<div class = "subject">
		<h4>What am I up to these days?</h4>
		<p>Working for <a class="green" target="blank" href="https://www.garmin.com/"> Garmin</a> as an intern in Olathe Kansas.</p>
		<p>I'm having a great time in the Aviation department working on obstacle maps.</p>
	</div>

	<div class = "subject">
		<h4>Here to check out Ben?</h4>
		<ul>
			<li><a target="blank" href="https://bit.ly/ben-resume">Resume</a></li>
			<li><a target="blank" href="https://bit.ly/sammons-github">Github</a></li>
			<li><a target="blank" href="https://bit.ly/sammons-careers">Stack Overflow</a></li>
			<li><a target="blank" href="https://bit.ly/sammons-linkedin">LinkedIn</a></li>
			<li><a target="blank" href="https://bit.ly/ben-sammons">Facebook</a></li>
			<li><a target="blank" href="https://bit.ly/sammons-twitter">Twitter</a></li>
			<li><a target="blank" href="https://bit.ly/sammons-google">Google+</a></li>
		</ul>
	</div>

	<!-- we aren't supposed to do it this way, but it works really well -->
	<div class = "spacer"> </div>

	<div class = "subject">
		<h4>Spark Stream</h4>
		<!-- video plugin -->
		<canvas id="videoCanvas" width="320" height="240">
			<p>
				Please use a browser that supports the Canvas Element, like
				<a href="http://www.google.com/chrome">Chrome</a>,
				<a href="http://www.mozilla.com/firefox/">Firefox</a>,
				<a href="http://www.apple.com/safari/">Safari</a> or Internet Explorer 10
			</p>
		</canvas>


	</div>

	<div class = "subject" id="spark-ui">
		<h4>Spark Console</h4>


	</div>

</div>

<!-- end main content -->

</body>
</html>